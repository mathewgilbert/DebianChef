<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DebianChef</title>
<style>
  body{font-family:Consolas,monospace;background:#0d1117;color:#c9d1d9;margin:40px;line-height:1.6}
  details>summary{cursor:pointer;list-style:none;color:#58a6ff;font-weight:bold}
  details>summary::-webkit-details-marker{display:none}
  details[open]>summary{margin-bottom:6px}
  .d{color:#79c0ff}
  .f{color:#8b949e}
  .html{color:#ffa657}
  .css{color:#7ee787}
  .js{color:#ffdb6d}
  .json,.md,.toml{color:#79c0ff}
  .png,.jpg,.jpeg,.webp,.svg,.gif,.ico{color:#a5d6ff}
  .indent{padding-left:20px}
</style>
</head>
<body>

<div id="tree"></div>

<script>
async function scan(dir = '.') {
  try {
    const res = await fetch(`${dir}?${Date.now()}`);
    const html = await res.text();
    const doc = new DOMParser().parseFromString(html, 'text/html');
    return Array.from(doc.querySelectorAll('a'))
      .map(a => a.textContent.trim())
      .filter(t => t && !['../', './'].includes(t))
      .sort((a, b) => {
        const aDir = a.endsWith('/');
        const bDir = b.endsWith('/');
        return bDir - aDir || a.localeCompare(b);
      });
  } catch (e) {
    document.getElementById('tree').textContent = 'Buka pakai Live Server!';
    return [];
  }
}

async function build() {
  const items = await scan('.');
  const container = document.getElementById('tree');
  container.innerHTML = '<details open><summary class="d">.</summary></details>';

  const root = container.querySelector('details');

  async function addItems(parentDetails, path) {
    const list = await scan(path);
    const div = document.createElement('div');
    div.className = 'indent';
    parentDetails.appendChild(div);

    for (const item of list) {
      const isDir = item.endsWith('/');
      const name = isDir ? item.slice(0, -1) : item;
      const ext = name.includes('.') ? name.split('.').pop() : '';

      if (isDir) {
        const det = document.createElement('details');
        const sum = document.createElement('summary');
        sum.textContent = name;
        sum.className = 'd';
        det.appendChild(sum);
        div.appendChild(det);
        await addItems(det, path + item); // rekursif masuk folder
      } else {
        const span = document.createElement('div');
        span.innerHTML = `<span class="f ${ext}">${name}</span>`;
        if (name === 'index.html') span.innerHTML += ' <small style="color:#555">(isi disembunyikan)</small>';
        div.appendChild(span);
      }
    }
  }

  await addItems(root, './');
}

build();
</script>
</body>
</html>
