<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>DebianChef</title>
<style>
  body {font-family: Consolas, monospace; background:#0d1117; color:#c9d1d9; margin:40px; line-height:1.6}
  summary {cursor:pointer; color:#58a6ff; font-weight:bold; list-style:none}
  summary::-webkit-details-marker {display:none}
  details[open] summary {margin-bottom:8px}
  .dir {color:#79c0ff}
  .file {color:#8b949e}
  .html{color:#ffa657}.css{color:#7ee787}.js{color:#ffdb6d}
  .json,.md,.yml,.yaml,.toml{color:#79c0ff}
  .png,.jpg,.jpeg,.webp,.svg,.gif,.ico{color:#a5d6ff}
  .i {padding-left:22px}
</style>
</head>
<body>

<div id="root"></div>

<script>
async function getList(path = "") {
  try {
    const r = await fetch(path + "?t=" + Date.now());
    const t = await r.text();
    const p = new DOMParser();
    const d = p.parseFromString(t, "text/html");
    return Array.from(d.querySelectorAll("a"))
      .map(a => a.textContent.trim())
      .filter(x => x && x !== "../" && x !== "./")
      .sort((a,b) => (b.endsWith("/") - a.endsWith("/")) || a.localeCompare(b));
  } catch(e) {
    document.getElementById("root").innerHTML = "<span style='color:#f85149'>Buka pakai Live Server atau python -m http.server</span>";
    return [];
  }
}

async function render() {
  const container = document.getElementById("root");
  container.innerHTML = `<details open><summary class="dir">DebianChef</summary></details>`;
  const rootDetails = container.firstChild;

  async function add(dirElement, currentPath) {
    const files = await getList(currentPath);
    if (files.length === 0) return;

    const box = document.createElement("div");
    box.className = "i";
    dirElement.appendChild(box);

    for (const f of files) {
      const isDir = f.endsWith("/");
      const name = isDir ? f.slice(0,-1) : f;
      const ext  = name.includes(".") ? name.split(".").pop() : "";

      if (isDir) {
        const det = document.createElement("details");
        const sum = document.createElement("summary");
        sum.textContent = name;
        sum.className = "dir";
        det.appendChild(sum);
        box.appendChild(det);
        await add(det, currentPath + f);  // masuk folder
      } else {
        const line = document.createElement("div");
        line.innerHTML = `<span class="file ${ext}">${name}</span>`;
        if (name === "index.html") line.innerHTML += ` <small style="color:#555">(isi disembunyikan)</small>`;
        box.appendChild(line);
      }
    }
  }

  await add(rootDetails, "");
}

render();
</script>
</body>
</html>
